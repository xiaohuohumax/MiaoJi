import{w as y,N as h,d as b,c as N}from"./loading-fb142471.js";import{C as P}from"./COver-5801d771.js";import{_ as S}from"./CSubTitle.vue_vue_type_script_setup_true_lang-a2d65008.js";import{d as w,a as k,a9 as m,a8 as t,af as e,al as B,am as $,aA as V,a6 as r,a4 as s,a7 as x,ak as I,F as L,ac as q,ad as d,ag as p,ae as z}from"./index-e356217c.js";import{N as A,_ as D}from"./CReactions.vue_vue_type_script_setup_true_lang-bcd65140.js";import{a as F}from"../app.config.js";import{N as G,a as O}from"./Grid-524587fd.js";import{N as T}from"./Card-5655ee7b.js";import"./use-locale-4b393f32.js";import"./VResizeObserver-47dafdf5.js";const j=["src","alt"],E={class:"text-lg mt-2 group-hover:text-green-300"},H={class:"text-center"},J={key:1,class:"text-center"},C=10,te=w({__name:"PPhoto",setup(K){let f=1;const l=k([]),u=y({state:"loading",fail:"相册查询失败!"}),g=k(!1);async function _(o){u.value="loading";const[n,a]=await B($.qIssuePage({labels:F.label.photoLabel,state:"all",page:o.toString(),per_page:C.toString()}));if(n){u.value="fail";return}(a.length==0||a.length<C)&&(g.value=!0);const i=a.map(c=>({...c,images:V(c.body)}));l.value.push(...i),u.value="success"}_(f);function v(){const o=l.value.length,n=f+1;_(n).then(()=>{o!=l.value.length&&(f+=n)})}return(o,n)=>(r(),m(e(N),{vertical:""},{default:t(()=>[s(e(S),{context:"相册"}),l.value.length>0?(r(),m(e(G),{key:0,cols:"1 s:2 m:3 l:4 xl:5 2xl:6",responsive:"screen","x-gap":8,"y-gap":8},{default:t(()=>[(r(!0),x(L,null,I(l.value,a=>(r(),m(e(O),{class:"group cursor-pointer",key:a.number,onClick:i=>o.$router.push("/photo/"+a.number)},{default:t(()=>[s(e(T),{size:"small",bordered:!1},{default:t(()=>{var i,c;return[d("img",{class:"object-cover rounded-md",src:(i=a.images[0])==null?void 0:i.src,alt:(c=a.images[0])==null?void 0:c.alt},null,8,j),s(e(N),{vertical:""},{default:t(()=>[d("div",E,z(a.title),1),d("div",null,[s(e(A),{time:new Date(a.updated_at),type:"relative"},null,8,["time"]),p("更新 ")]),s(D,{reactions:a.reactions},null,8,["reactions"])]),_:2},1024)]}),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):q("",!0),s(e(b),{state:e(u)},{fail:t(()=>[d("div",H,[s(e(h),{onClick:v},{default:t(()=>[p(" 重试 ")]),_:1})])]),default:t(()=>[g.value?(r(),m(e(P),{key:0})):(r(),x("div",J,[s(e(h),{onClick:v},{default:t(()=>[p(" 更多 ")]),_:1})]))]),_:1},8,["state"])]),_:1}))}});export{te as default};
