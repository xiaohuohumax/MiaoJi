import{w as V,N as h,d as A,c as m}from"./loading-8758b90e.js";import{C as I}from"./COver-ad4c1e72.js";import{_ as F}from"./CSubTitle.vue_vue_type_script_setup_true_lang-dc9e79c0.js";import{d as G,a as i,a9 as f,a8 as t,af as a,al as k,am as L,ay as O,a6 as n,a4 as s,a7 as C,ak as $,F as D,ad as r,ag as g,ac as E,ae as w}from"./index-f2d47f63.js";import{a as S}from"../app.config.js";import{N as T,a as j}from"./Grid-516d8f6c.js";import{N as z}from"./Card-27a8e976.js";import"./VResizeObserver-0e0df771.js";const H=["href"],J=["src","alt"],K={size:"small",class:"flex items-center text-xl hover:text-green-300"},M=["href"],Q={size:"small",class:"flex items-center hover:text-green-300"},R=["href"],U={class:"text-center"},W={key:1,class:"text-center"},X=["href"],P=10,ne=G({__name:"PLink",setup(Y){let d=1;const c=i([]),u=V({state:"loading",fail:"友链查询失败!"}),p=i(!1);async function v(o){u.value="loading";const[l,e]=await k(L.qIssuePage({labels:S.label.linkLabel,state:"all",page:o.toString(),per_page:P.toString()}));if(l){u.value="fail";return}(e.length==0||e.length<P)&&(p.value=!0);const q=e.map(b=>{const N=O(b.body);return{...b,anchor:N.length>0?N[0]:null}});c.value.push(...q),u.value="success"}v(d);function x(){const o=c.value.length,l=d+1;v(l).then(()=>{o!=c.value.length&&(d+=l)})}const y=i(null),_=i("loading");async function B(){const[o,l]=await k(L.qIssuePage({labels:S.label.applyLinkLabel,state:"all",page:"1",per_page:"1"}));if(o||l.length==0){_.value="fail";return}y.value=l[0],_.value="success"}return B(),(o,l)=>(n(),f(a(m),{vertical:""},{default:t(()=>[s(a(F),{context:"友链"}),s(a(T),{cols:"1 s:2 m:3 l:4 xl:5 2xl:6",responsive:"screen","x-gap":12,"y-gap":12},{default:t(()=>[(n(!0),C(D,null,$(c.value,e=>(n(),f(a(j),{key:e.number},{default:t(()=>[s(a(z),{size:"small",bordered:!1},{default:t(()=>[s(a(m),{class:"h-full"},{default:t(()=>[r("a",{class:"font-bold flex-shrink-0 mt-1",target:"_blank",href:e.user.html_url},[r("img",{class:"w-16 rounded-md mx-auto hover:scale-105 duration-100",src:e.user.avatar_url,alt:e.user.login},null,8,J)],8,H),s(a(m),{size:"small",vertical:"",class:"flex-grow"},{default:t(()=>[r("div",K,[r("a",{href:e.anchor?e.anchor.href:e.user.html_url,target:"_blank"},w(e.anchor?e.anchor.content:e.title),9,M)]),r("div",Q,[r("a",{href:e.user.html_url,target:"_blank"},w(e.user.login),9,R)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),s(a(A),{state:a(u)},{fail:t(()=>[r("div",U,[s(a(h),{onClick:x},{default:t(()=>[g(" 重试 ")]),_:1})])]),default:t(()=>[p.value?(n(),f(a(I),{key:0})):(n(),C("div",W,[s(a(h),{onClick:x},{default:t(()=>[g(" 更多 ")]),_:1})]))]),_:1},8,["state"]),_.value=="success"?(n(),f(a(z),{key:0,size:"small",bordered:!1},{default:t(()=>[r("a",{href:y.value.html_url,target:"_blank"},[s(a(h),{class:"w-full",type:"info"},{default:t(()=>[g("去申请")]),_:1})],8,X)]),_:1})):E("",!0)]),_:1}))}});export{ne as default};
