import{w as P,N as b,_ as V}from"./loading-aba46111.js";import{_ as I}from"./COver.vue_vue_type_script_setup_true_lang-ad340878.js";import{C as $}from"./CMarkdown-50e9d5bf.js";import{d as q,ah as A,ai as D,a as N,p as F,az as O,a6 as o,a9 as d,a8 as t,a4 as a,ad as n,ae as i,af as e,ag as p,a7 as C,F as S,al as T,ac as j,am as E,bg as M}from"./index-bab370b4.js";import{N as G,_ as H}from"./CReactions.vue_vue_type_script_setup_true_lang-b9f92b05.js";import{a as J}from"../app.config.js";import{N as m,j as h}from"./Space-7508ea39.js";const K=["href"],Q={class:"flex"},R=["href"],U=["src"],W=["href"],X={class:"font-bold text-xl hover:text-green-300"},Y={class:"text-center"},Z={key:1,class:"text-center"},z=10,re=q({__name:"CComments",props:{issue:{},title:{}},setup(L){const{t:r}=A(),B=D(),f=L,c=N([]),_=P({state:"init",fail:()=>r("component.cLoading.fail",{name:f.title})}),k=N(!1);let g=1;const x=F(()=>O(f.issue.labels,J.label.hiddenCommentLabel));async function w(l,u){if(x.value)return;_.value="loading";const[s,v]=await E(M.qCommentsByIssueId(l,{page:u.toString(),per_page:z.toString()}));if(s){_.value="fail";return}(v.data.length==0||v.data.length<z)&&(k.value=!0),c.value.push(...v.data),_.value="success"}w(f.issue.number.toString(),g);function y(){const l=c.value.length,u=l==0?1:g+1;w(f.issue.number.toString(),u).then(()=>{l!=c.value.length&&(g+=u)})}return(l,u)=>(o(),d(e(h),{vertical:""},{default:t(()=>[a(e(m),{class:"font-bold",size:"small",bordered:!1},{default:t(()=>[n("p",null,i(l.title)+":",1)]),_:1}),x.value?(o(),d(e(m),{key:0,class:"font-bold p-2 text-center",size:"small",bordered:!1},{default:t(()=>[p(i(e(r)("component.cComments.hiddenContext",{title:l.title})),1)]),_:1})):(o(),C(S,{key:1},[a(e(m),{size:"small",bordered:!1},{default:t(()=>[n("a",{href:l.issue.html_url,target:"_blank"},[a(e(b),{class:"w-full",type:"info"},{default:t(()=>[p(i(e(r)("component.cComments.gotoComment",{title:l.title.toLocaleLowerCase()})),1)]),_:1})],8,K)]),_:1}),c.value.length>0?(o(),d(e(h),{key:0,vertical:""},{default:t(()=>[(o(!0),C(S,null,T(c.value,s=>(o(),d(e(m),{size:"small",key:s.id,bordered:!1},{default:t(()=>[n("div",Q,[n("a",{target:"_blank",href:s.user.html_url},[n("img",{src:s.user.avatar_url,class:"rounded-md block w-16 h-16 flex-shrink-0 hover:scale-105 duration-100"},null,8,U)],8,R),a(e(h),{vertical:"",class:"ml-2 flex-grow w-0"},{default:t(()=>[n("a",{target:"_blank",href:s.user.html_url},[n("span",X,i(s.user.login),1)],8,W),a(e(h),{align:"center"},{default:t(()=>[a(e(G),{time:new Date(s.updated_at),type:"relative"},null,8,["time"]),a(H,{class:"inline-block",reactions:s.reactions},null,8,["reactions"])]),_:2},1024),a(e(m),{bordered:!1,size:"small",class:"w-full overflow-hidden"},{default:t(()=>[a(e($),{text:s.body,class:"rounded-lg",id:s.id,theme:e(B).theme.markdown},null,8,["text","id","theme"])]),_:2},1024)]),_:2},1024)])]),_:2},1024))),128))]),_:1})):j("",!0),a(e(V),{state:e(_)},{fail:t(()=>[n("div",Y,[a(e(b),{onClick:y,class:"mx-auto"},{default:t(()=>[p(i(e(r)("comment.button.retry")),1)]),_:1})])]),default:t(()=>[k.value?(o(),d(e(I),{key:0,context:e(r)("component.cOver.context")},null,8,["context"])):(o(),C("div",Z,[a(e(b),{onClick:y,class:"mx-auto"},{default:t(()=>[p(i(e(r)("comment.button.more")),1)]),_:1})]))]),_:1},8,["state"])],64))]),_:1}))}});export{re as _};
