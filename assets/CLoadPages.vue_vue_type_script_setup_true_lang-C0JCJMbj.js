import{e as C,aR as w,at as h,aS as q,r as y,ag as m,am as I,al as d,l as o,ah as g,ap as S,aq as a,aT as V,ai as k,ak as r,ar as N,as as v}from"./index-hgVmP53t.js";import{a as M}from"../app.config.DHJUAgkF.js";import{N as _,I as x,B as P}from"./CLink.vue_vue_type_script_setup_true_lang-CBIeQepy.js";import{N as E}from"./Empty-D189VURL.js";import{N as F}from"./Space-CIlk5P2J.js";const Q={class:"text-center p-2"},T={class:"text-center"},R=C({__name:"CLoadPages",props:w({perPage:{default:M.perPage},autoQuery:{type:Boolean,default:!0},state:{default:"init"},queryPagesFunc:{}},{datas:{default:()=>[]},datasModifiers:{}}),emits:["update:datas"],setup(f,{expose:$}){const l=f,{t:p}=h(),n=q(f,"datas"),c=y(1),e=y(l.state);async function u(t){if(e.value==="empty"||e.value==="over")return;e.value="loading",c.value+=t;const[s,i]=await V(l.queryPagesFunc(c.value,l.perPage));if(s){e.value="error";return}n.value.push(...i.datas),e.value=i.hasNext?"more":n.value.length===0?"empty":"over"}l.autoQuery&&u(0);function B(){e.value="init",c.value=1,n.value=[]}return $({init:B,queryPages:u}),(t,s)=>(m(),I(a(F),{vertical:!0},{default:d(()=>[o(t.$slots,"default",{datas:n.value}),e.value==="loading"?o(t.$slots,"loading",{key:0},()=>[k("div",Q,[r(a(_),{size:30},{default:d(()=>[r(a(x),{class:"animate-spin inline-block"})]),_:1})])]):e.value==="error"?(m(),g("div",{key:1,onClick:s[0]||(s[0]=i=>u(0))},[o(t.$slots,"error",{},()=>[r(a(P),{class:"w-full",secondary:"",type:"warning"},{default:d(()=>[N(v(a(p)("component.loadPages.retry")),1)]),_:1})])])):e.value==="more"?(m(),g("div",{key:2,onClick:s[1]||(s[1]=i=>u(1))},[o(t.$slots,"more",{},()=>[r(a(P),{class:"w-full",secondary:"",type:"info"},{default:d(()=>[N(v(a(p)("component.loadPages.more")),1)]),_:1})])])):e.value==="over"?o(t.$slots,"over",{key:3},()=>[k("p",T,v(a(p)("component.loadPages.over")),1)]):e.value==="empty"?o(t.$slots,"empty",{key:4},()=>[r(a(E),{class:"p-4"})]):S("",!0)]),_:3}))}});export{R as _};
