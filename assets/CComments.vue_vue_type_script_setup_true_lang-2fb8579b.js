import{w as P,N as b,_ as I}from"./loading-1effc8e2.js";import{_ as V}from"./COver.vue_vue_type_script_setup_true_lang-649c7464.js";import{C as q}from"./CMarkdown-5c84e946.js";import{d as $,aq as A,ar as D,a as N,g as O,aI as T,af as o,ai as d,ah as t,ad as a,am as n,an as i,ao as e,ap as h,ag as k,S,av as E,al as F,aw as M,bm as j}from"./index-64af288b.js";import{N as G,_ as H}from"./CReactions.vue_vue_type_script_setup_true_lang-710c4c59.js";import{a as J}from"../app.config.dacfcbaa.js";import{N as m,h as p}from"./Space-65dedc3e.js";const K=["href"],Q={class:"flex"},R=["href"],U=["src"],W=["href"],X={class:"font-bold text-xl hover:text-orange-500 dark:hover:text-green-300"},Y={class:"text-center"},Z={key:1,class:"text-center"},L=10,re=$({__name:"CComments",props:{issue:{},title:{}},setup(z){const{t:r}=A(),B=D(),f=z,c=N([]),_=P({state:"init",fail:()=>r("component.cLoading.fail",{name:f.title})}),C=N(!1);let g=1;const x=O(()=>T(f.issue.labels,J.label.hiddenCommentLabel));async function w(l,u){if(x.value)return;_.value="loading";const[s,v]=await M(j.qCommentsByIssueId(l,{page:u.toString(),per_page:L.toString()}));if(s){_.value="fail";return}(v.data.length==0||v.data.length<L)&&(C.value=!0),c.value.push(...v.data),_.value="success"}w(f.issue.number.toString(),g);function y(){const l=c.value.length,u=l==0?1:g+1;w(f.issue.number.toString(),u).then(()=>{l!=c.value.length&&(g+=u)})}return(l,u)=>(o(),d(e(p),{vertical:""},{default:t(()=>[a(e(m),{class:"font-bold",size:"small",bordered:!1},{default:t(()=>[n("p",null,i(l.title)+":",1)]),_:1}),x.value?(o(),d(e(m),{key:0,class:"font-bold p-2 text-center",size:"small",bordered:!1},{default:t(()=>[h(i(e(r)("component.cComments.hiddenContext",{title:l.title})),1)]),_:1})):(o(),k(S,{key:1},[a(e(m),{size:"small",bordered:!1},{default:t(()=>[n("a",{href:l.issue.html_url,target:"_blank"},[a(e(b),{class:"w-full",type:"info"},{default:t(()=>[h(i(e(r)("component.cComments.gotoComment",{title:l.title.toLocaleLowerCase()})),1)]),_:1})],8,K)]),_:1}),c.value.length>0?(o(),d(e(p),{key:0,vertical:""},{default:t(()=>[(o(!0),k(S,null,E(c.value,s=>(o(),d(e(m),{size:"small",key:s.id,bordered:!1},{default:t(()=>[n("div",Q,[n("a",{target:"_blank",href:s.user.html_url},[n("img",{src:s.user.avatar_url,class:"rounded-md block w-16 h-16 flex-shrink-0 hover:scale-105 duration-100"},null,8,U)],8,R),a(e(p),{vertical:"",class:"ml-2 flex-grow w-0"},{default:t(()=>[n("a",{target:"_blank",href:s.user.html_url},[n("span",X,i(s.user.login),1)],8,W),a(e(p),{align:"center"},{default:t(()=>[a(e(G),{time:new Date(s.updated_at),type:"relative"},null,8,["time"]),a(H,{class:"inline-block",reactions:s.reactions},null,8,["reactions"])]),_:2},1024),a(e(m),{bordered:!1,size:"small",class:"w-full overflow-hidden"},{default:t(()=>[a(e(q),{text:s.body,class:"rounded-lg",id:s.id,theme:e(B).theme.markdown},null,8,["text","id","theme"])]),_:2},1024)]),_:2},1024)])]),_:2},1024))),128))]),_:1})):F("",!0),a(e(I),{state:e(_)},{fail:t(()=>[n("div",Y,[a(e(b),{onClick:y,class:"mx-auto"},{default:t(()=>[h(i(e(r)("comment.button.retry")),1)]),_:1})])]),default:t(()=>[C.value?(o(),d(e(V),{key:0,context:e(r)("component.cOver.context")},null,8,["context"])):(o(),k("div",Z,[a(e(b),{onClick:y,class:"mx-auto"},{default:t(()=>[h(i(e(r)("comment.button.more")),1)]),_:1})]))]),_:1},8,["state"])],64))]),_:1}))}});export{re as _};
